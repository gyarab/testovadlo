#!/bin/bash

function jj { local IFS=":"; echo "$*"; }

main=$(head -1 /data/.mainclass)
jars=( . $(find / -maxdepth 1 -type f -name '*.jar') )


echo "$ java -cp $(jj "${jars[@]#/}") $main"

Xvfb :99 -screen 0 1024x768x24 & xvfdpid=$!

(cd /data/build; DISPLAY=:99 java -cp $(jj "${jars[@]}") "$main") &

sleep 10

xwd -root -display :99 | xwdtopnm 2>/dev/null | pnmcrop -black | pnmtojpeg > /output/screen.jpg
